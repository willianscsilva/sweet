# -----------------------------------------------------------------------------
# FEDORA - PYTHON
# -----------------------------------------------------------------------------
FROM fedora:23

# -----------------------------------------------------------------------------
# Install Python dependencies
# -----------------------------------------------------------------------------
RUN dnf install -y python3-mysql.x86_64
RUN dnf install -y python3-xtermcolor.noarch
RUN dnf install python3-pip
RUN pip3 install validate_email
RUN pip3 install redis

# -----------------------------------------------------------------------------
# Install CRON
# -----------------------------------------------------------------------------
RUN dnf install -y cronie

# -----------------------------------------------------------------------------
# UTILS
# -----------------------------------------------------------------------------
RUN dnf install -y htop grep procps-ng

# -----------------------------------------------------------------------------
# WATCH
# -----------------------------------------------------------------------------
RUN dnf install -y dwatch.x86_64

# -----------------------------------------------------------------------------
# Copy Cron config
# -----------------------------------------------------------------------------
COPY files/cron.conf /var/spool/cron/root
RUN chmod 600 /var/spool/cron/root

# -----------------------------------------------------------------------------
# DEFINE WORKDIR
# -----------------------------------------------------------------------------
WORKDIR /home/

# -----------------------------------------------------------------------------
# Set Environment & Work dir
# -----------------------------------------------------------------------------
ARG env
RUN echo "export APP_ENV=$env" >> /etc/environment

# -----------------------------------------------------------------------------
# Init Bash
# -----------------------------------------------------------------------------
ADD files/init.sh  /usr/bin/init.sh
RUN chmod -v +x /usr/bin/init.sh

# -----------------------------------------------------------------------------
# Execute init.sh on container start
# -----------------------------------------------------------------------------
CMD ["/usr/sbin/init","/usr/sbin/crond"]


